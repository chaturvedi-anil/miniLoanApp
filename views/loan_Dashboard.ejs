<link rel="stylesheet" href="/css/dashboard.css">
<link rel="stylesheet" href="/css/loan_Dashboard.css">
<main class="main-container">
    <!-- checking for user -->
    <% if(locals.user) { %>
        <!-- Sidebar -->
        <div class="sidebar">
            <!-- TODO design for active list and in active list-->
            <ul class="nav">
                <li class="nav-item">
                    <a class="nav-link" href="/customer/dashboard"> Profile</a>
                </li>
                <li class="nav-item" onclick="toggleDashboards('customer-dashboard')">
                    <a class="nav-link"> Loans</a>
                </li>
                <li class="nav-item" onclick="toggleDashboards('loan-dashboard')">
                    <a class="nav-link">Loan history</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="/customer/destroy-session">Sign Out</a>
                </li>
            </ul>
        </div>

        <!-- Customer dashboard div Main Content -->
        <div class="main-content" id="customer-dashboard">
            <div class="btn-container">
                <button class="btn new-loan-btn" onclick="toggleLoanApplication()">
                    Apply For Loan
                </button>
                <div class="new-loan-form-container" id="loan-form-container">
                    <h1> New Loan Application </h1>
                    
                    <form action="/customer/loans/loanApplication/<%=user.id%>" method="post" onsubmit="closeLoanApplication()">
                        <input type="hidden" name="customer" value="<%= user.id %>" required>
                        <input type="number" name="amount" placeholder="Enter Loan Amount like. 10000" maxlength="9" required>
                        <input type="number" name="term" placeholder="Enter Term In Weeks" required>
                        <input type="submit" value="Submit Application" class="btn submit-btn">
                    </form>
                </div>
            </div>
            <div class="container">
                <h1>All Approved Loan List</h1>
                <div class="approved-loans">
                    <table class="loan-table">
                        <thead>
                            <tr>
                                <th>Loan Amount</th>
                                <th>Loan Term</th>
                                <th>Loan Status</th>
                                <th>Applied Date</th>
                            </tr>
                        </thead>
                        <tbody>
                            <% for(let loanList of approvedLoanList) { %>
                                <tr class="loan-details">
                                    <td><%= loanList.amount %> </td>
                                    <td><%= loanList.term %> </td>
                                    <td><%= loanList.status %> </td>
                                    <td><%= loanList.appliedDate%> </td>
                                </tr>
                            <% } %>
                        </tbody>
                    </table>
                </div>
            </div>            
        </div>

        <!-- Show Loan History -->
        <div class="main-content" id="loan-dashboard">
            <div class="container">
                <h1>All Loan List</h1>
                <div class="approved-loans">
                    <table class="loan-table">
                        <thead>
                            <tr>
                                <th>Loan Amount</th>
                                <th>Loan Term</th>
                                <th>Loan Status</th>
                                <th>Applied Date</th>
                            </tr>
                        </thead>
                        <tbody>
                            <% for(let loanList of allLoanList) { %>
                                <tr class="loan-details">
                                    <td><%= loanList.amount %> </td>
                                    <td><%= loanList.term %> </td>
                                    <td><%= loanList.status %> </td>
                                    <td><%= loanList.appliedDate%> </td>
                                </tr>
                            <% } %>
                        </tbody>
                    </table>
                </div>
            </div>            
        </div>
    <% } %>
</main>

<script src="/javascript/loan.js"></script>